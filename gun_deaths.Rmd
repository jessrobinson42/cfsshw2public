---
title: "Exploring Gun Deaths in America"
author: "Jess Robinson"
output: github_document
---

## Get the data

```{r}
library(tidyverse)    # load tidyverse packages, including ggplot2
library(rcfss)
library(knitr)
# load the data
data("gun_deaths")
gun_deaths 
```

## Generate a data frame that summarizes the number of gun deaths per month.

### Print the data frame as a formatted `kable()` table.
```{r}
gun_deaths <- gun_deaths %>%
  mutate(Months = factor(month, levels = seq(from = 1, to = 12), labels = month.abb))
month_death <- gun_deaths %>%
  count(Months) %>% rename("Month" = Months, "Number of Gun Deaths"= n)
kable(month_death)
```

### Generate a bar chart with human-readable labels on the x-axis. That is, each month should be labeled "Jan", "Feb", "Mar" (full or abbreviated month names are fine), not `1`, `2`, `3`.

```{r}
ggplot(gun_deaths, aes(Months)) +
  geom_bar() +
  labs(title = "Gun Deaths per Month",
       x = "Month",
       y = "Number of Gun Deaths")
```

## Generate a bar chart that identifies the number of gun deaths associated with each type of intent cause of death. The bars should be sorted from highest to lowest values.

```{r}
gun_deaths %>% 
  mutate(intent = intent %>% fct_infreq()) %>%
ggplot(aes(intent)) +
  geom_bar() +
  labs(title = "Gun Deaths by Intent",
       x = "Type of Intent",
       y = "Number of Gun Deaths"
       )
```

## Generate a boxplot visualizing the age of gun death victims, by sex. Print the average age of female gun death victims.

```{r}
ggplot(gun_deaths, aes(sex, age)) +
  geom_boxplot() +
  labs(title = "Gun Death Victim Age by Sex of Victim",
       x = "Sex of Victim",
       y = "Age of Death"
  )

kable(gun_deaths %>% filter(sex== "F")
      %>% summarise("Average Age of Female Gun Death Victims" = mean(age, na.rm=TRUE)))
```


## How many white males with at least a high school education were killed by guns in 2012?

```{r}
edwm_2012_deaths <- gun_deaths %>%
  filter(education != "Less than HS")  %>%
  filter(sex == "M")  %>%
  filter(race == "White")  %>%
  filter(year == "2012")
kable(tally(edwm_2012_deaths))
```
There were **15199** white males with at least a high school education killed by guns in 2012.

## Which season of the year has the most gun deaths?

Assume that:

* Winter = January-March
* Spring = April-June
* Summer = July-September
* Fall = October-December

```{r}
gun_deaths <- gun_deaths %>%
  mutate(Season = cut(month, c(0, 3, 6, 9, 12), labels = c("Winter", "Spring", "Summer", "Fall")))
season_death <- gun_deaths %>%
  count(Season) %>% rename("Number of Gun Deaths"= n)
kable(season_death)
```

```{r}
ggplot(gun_deaths, aes(Season)) +
  geom_bar() +
  labs(title = "Gun Deaths per Season",
       x = "Season",
       y = "Number of Gun Deaths")
```

# Are whites who are killed by guns more likely to die because of suicide or homicide? How does this compare to blacks and hispanics?

```{r}
rda <- gun_deaths %>% 
  filter(race != "Asian/Pacific Islander") 
race_deaths <- rda %>% 
  filter(race != "Native American/Native Alaskan")
ggplot(race_deaths, aes(x = race, fill = intent)) + 
  geom_bar(position = "fill") + coord_flip() + 
  labs(title = "Gun Deaths",
       x = "Race",
       y = "Proportion",
       fill = "Intent")
```

White are more likely to die by because suicide than homicide. 
In comparison, blacks and hispanics are both more likely to die by homicide than suicide. 

## Are police-involved gun deaths significantly different from other gun deaths? Assess the relationship between police involvement and age, police involvement and race, and the intersection of all three variables.

```{r}
####mutate police involvement into factor
gun_deaths <- gun_deaths %>% mutate(PolInv = factor(police, labels = c("Not Involved", "Involved")))


####plot police vs. race
ggplot(gun_deaths, aes(x = PolInv, fill = race)) +
       geom_bar(position = "fill") +
        labs(title = "Police Involvement in Gun Deaths by Race",
       x = "Police Involvement",
       y = "Proportion",
       fill = "Race")

####plot police vs. age 
ggplot(gun_deaths, aes(x = PolInv, y = age)) +
       geom_boxplot() +
 labs(title = "Police Involvement in Gun Deaths by Age",
       x = "Police Involvement",
       y = "Age"
        )

####plot police, age, race
ggplot(gun_deaths, aes(x = race, y = age, fill = PolInv)) +
       geom_boxplot() +
  coord_flip() + 
 labs(title = "P",
       x = "Race",
       y = "Age",
      fill = "Police Involvement"  )
```

## Session info

```{r}
# don't modify this chunk
devtools::session_info()
```


